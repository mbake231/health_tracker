{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/defineProperty\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}import React,{useCallback,useEffect,useMemo,useRef}from'react';import View from\"react-native-web/dist/exports/View\";import ScrollView from\"react-native-web/dist/exports/ScrollView\";import min from'lodash/min';import map from'lodash/map';import constants from\"../commons/constants\";import styleConstructor,{HOURS_SIDEBAR_WIDTH}from\"./style\";import{populateEvents,HOUR_BLOCK_HEIGHT}from\"./Packer\";import{calcTimeOffset}from\"./helpers/presenter\";import TimelineHours from\"./TimelineHours\";import EventBlock from\"./EventBlock\";import NowIndicator from\"./NowIndicator\";import useTimelineOffset from\"./useTimelineOffset\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Timeline=function Timeline(props){var _props$format24h=props.format24h,format24h=_props$format24h===void 0?true:_props$format24h,_props$start=props.start,start=_props$start===void 0?0:_props$start,_props$end=props.end,end=_props$end===void 0?24:_props$end,date=props.date,_props$events=props.events,events=_props$events===void 0?[]:_props$events,onEventPress=props.onEventPress,onBackgroundLongPress=props.onBackgroundLongPress,onBackgroundLongPressOut=props.onBackgroundLongPressOut,renderEvent=props.renderEvent,theme=props.theme,scrollToFirst=props.scrollToFirst,scrollToNow=props.scrollToNow,initialTime=props.initialTime,showNowIndicator=props.showNowIndicator,scrollOffset=props.scrollOffset,onChangeOffset=props.onChangeOffset,overlapEventsSpacing=props.overlapEventsSpacing,rightEdgeSpacing=props.rightEdgeSpacing,unavailableHours=props.unavailableHours,unavailableHoursColor=props.unavailableHoursColor,eventTapped=props.eventTapped;var scrollView=useRef();var calendarHeight=useRef((end-start)*HOUR_BLOCK_HEIGHT);var styles=useRef(styleConstructor(theme||props.styles,calendarHeight.current));var _useTimelineOffset=useTimelineOffset({onChangeOffset:onChangeOffset,scrollOffset:scrollOffset,scrollViewRef:scrollView}),scrollEvents=_useTimelineOffset.scrollEvents;var packedEvents=useMemo(function(){var width=constants.screenWidth-HOURS_SIDEBAR_WIDTH;return populateEvents(events,{screenWidth:width,dayStart:start,overlapEventsSpacing:overlapEventsSpacing,rightEdgeSpacing:rightEdgeSpacing});},[events,start]);useEffect(function(){var initialPosition=0;if(scrollToNow){initialPosition=calcTimeOffset(HOUR_BLOCK_HEIGHT);}else if(scrollToFirst&&packedEvents.length>0){var _min;initialPosition=(_min=min(map(packedEvents,'top')))!=null?_min:0;}else if(initialTime){initialPosition=calcTimeOffset(HOUR_BLOCK_HEIGHT,initialTime.hour,initialTime.minutes);}if(initialPosition){setTimeout(function(){var _scrollView$current;scrollView==null?void 0:(_scrollView$current=scrollView.current)==null?void 0:_scrollView$current.scrollTo({y:Math.max(0,initialPosition-HOUR_BLOCK_HEIGHT),animated:true});},0);}},[]);var _onEventPress=useCallback(function(eventIndex){var event=packedEvents[eventIndex];if(eventTapped){eventTapped(event);}else{onEventPress==null?void 0:onEventPress(event);}},[packedEvents,onEventPress,eventTapped]);var renderEvents=function renderEvents(){var events=packedEvents.map(function(event,i){return _jsx(EventBlock,{index:i,event:event,styles:styles.current,format24h:format24h,onPress:_onEventPress,renderEvent:renderEvent},i);});return _jsx(View,{children:_jsx(View,{style:{marginLeft:HOURS_SIDEBAR_WIDTH},children:events})});};return _jsxs(ScrollView,_objectSpread(_objectSpread({ref:scrollView,contentContainerStyle:[styles.current.contentStyle,{width:constants.screenWidth}]},scrollEvents),{},{children:[_jsx(TimelineHours,{start:start,end:end,date:date,format24h:format24h,styles:styles.current,unavailableHours:unavailableHours,unavailableHoursColor:unavailableHoursColor,onBackgroundLongPress:onBackgroundLongPress,onBackgroundLongPressOut:onBackgroundLongPressOut}),renderEvents(),showNowIndicator&&_jsx(NowIndicator,{styles:styles.current})]}));};export default React.memo(Timeline);","map":{"version":3,"sources":["/Users/mikebaker/health_tracker/client/node_modules/react-native-calendars/src/timeline/Timeline.js"],"names":["React","useCallback","useEffect","useMemo","useRef","min","map","constants","styleConstructor","HOURS_SIDEBAR_WIDTH","populateEvents","HOUR_BLOCK_HEIGHT","calcTimeOffset","TimelineHours","EventBlock","NowIndicator","useTimelineOffset","Timeline","props","format24h","start","end","date","events","onEventPress","onBackgroundLongPress","onBackgroundLongPressOut","renderEvent","theme","scrollToFirst","scrollToNow","initialTime","showNowIndicator","scrollOffset","onChangeOffset","overlapEventsSpacing","rightEdgeSpacing","unavailableHours","unavailableHoursColor","eventTapped","scrollView","calendarHeight","styles","current","scrollViewRef","scrollEvents","packedEvents","width","screenWidth","dayStart","initialPosition","length","hour","minutes","setTimeout","scrollTo","y","Math","max","animated","_onEventPress","eventIndex","event","renderEvents","i","marginLeft","contentStyle","memo"],"mappings":"w0BAAA,MAAOA,CAAAA,KAAP,EAAgBC,WAAhB,CAA6BC,SAA7B,CAAwCC,OAAxC,CAAiDC,MAAjD,KAA+D,OAA/D,C,sHAEA,MAAOC,CAAAA,GAAP,KAAgB,YAAhB,CACA,MAAOC,CAAAA,GAAP,KAAgB,YAAhB,CACA,MAAOC,CAAAA,SAAP,4BACA,MAAOC,CAAAA,gBAAP,EAA2BC,mBAA3B,eACA,OAASC,cAAT,CAAyBC,iBAAzB,gBACA,OAASC,cAAT,2BACA,MAAOC,CAAAA,aAAP,uBACA,MAAOC,CAAAA,UAAP,oBACA,MAAOC,CAAAA,YAAP,sBACA,MAAOC,CAAAA,iBAAP,2B,wFACA,GAAMC,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACC,KAAD,CAAW,CACxB,qBAA+UA,KAA/U,CAAQC,SAAR,CAAQA,SAAR,2BAAoB,IAApB,+BAA+UD,KAA/U,CAA0BE,KAA1B,CAA0BA,KAA1B,uBAAkC,CAAlC,yBAA+UF,KAA/U,CAAqCG,GAArC,CAAqCA,GAArC,qBAA2C,EAA3C,YAA+CC,IAA/C,CAA+UJ,KAA/U,CAA+CI,IAA/C,eAA+UJ,KAA/U,CAAqDK,MAArD,CAAqDA,MAArD,wBAA8D,EAA9D,eAAkEC,YAAlE,CAA+UN,KAA/U,CAAkEM,YAAlE,CAAgFC,qBAAhF,CAA+UP,KAA/U,CAAgFO,qBAAhF,CAAuGC,wBAAvG,CAA+UR,KAA/U,CAAuGQ,wBAAvG,CAAiIC,WAAjI,CAA+UT,KAA/U,CAAiIS,WAAjI,CAA8IC,KAA9I,CAA+UV,KAA/U,CAA8IU,KAA9I,CAAqJC,aAArJ,CAA+UX,KAA/U,CAAqJW,aAArJ,CAAoKC,WAApK,CAA+UZ,KAA/U,CAAoKY,WAApK,CAAiLC,WAAjL,CAA+Ub,KAA/U,CAAiLa,WAAjL,CAA8LC,gBAA9L,CAA+Ud,KAA/U,CAA8Lc,gBAA9L,CAAgNC,YAAhN,CAA+Uf,KAA/U,CAAgNe,YAAhN,CAA8NC,cAA9N,CAA+UhB,KAA/U,CAA8NgB,cAA9N,CAA8OC,oBAA9O,CAA+UjB,KAA/U,CAA8OiB,oBAA9O,CAAoQC,gBAApQ,CAA+UlB,KAA/U,CAAoQkB,gBAApQ,CAAsRC,gBAAtR,CAA+UnB,KAA/U,CAAsRmB,gBAAtR,CAAwSC,qBAAxS,CAA+UpB,KAA/U,CAAwSoB,qBAAxS,CAA+TC,WAA/T,CAA+UrB,KAA/U,CAA+TqB,WAA/T,CACA,GAAMC,CAAAA,UAAU,CAAGpC,MAAM,EAAzB,CACA,GAAMqC,CAAAA,cAAc,CAAGrC,MAAM,CAAC,CAACiB,GAAG,CAAGD,KAAP,EAAgBT,iBAAjB,CAA7B,CACA,GAAM+B,CAAAA,MAAM,CAAGtC,MAAM,CAACI,gBAAgB,CAACoB,KAAK,EAAIV,KAAK,CAACwB,MAAhB,CAAwBD,cAAc,CAACE,OAAvC,CAAjB,CAArB,CACA,uBAAyB3B,iBAAiB,CAAC,CAAEkB,cAAc,CAAdA,cAAF,CAAkBD,YAAY,CAAZA,YAAlB,CAAgCW,aAAa,CAAEJ,UAA/C,CAAD,CAA1C,CAAQK,YAAR,oBAAQA,YAAR,CACA,GAAMC,CAAAA,YAAY,CAAG3C,OAAO,CAAC,UAAM,CAC/B,GAAM4C,CAAAA,KAAK,CAAGxC,SAAS,CAACyC,WAAV,CAAwBvC,mBAAtC,CACA,MAAOC,CAAAA,cAAc,CAACa,MAAD,CAAS,CAAEyB,WAAW,CAAED,KAAf,CAAsBE,QAAQ,CAAE7B,KAAhC,CAAuCe,oBAAoB,CAApBA,oBAAvC,CAA6DC,gBAAgB,CAAhBA,gBAA7D,CAAT,CAArB,CACH,CAH2B,CAGzB,CAACb,MAAD,CAASH,KAAT,CAHyB,CAA5B,CAIAlB,SAAS,CAAC,UAAM,CACZ,GAAIgD,CAAAA,eAAe,CAAG,CAAtB,CACA,GAAIpB,WAAJ,CAAiB,CACboB,eAAe,CAAGtC,cAAc,CAACD,iBAAD,CAAhC,CACH,CAFD,IAGK,IAAIkB,aAAa,EAAIiB,YAAY,CAACK,MAAb,CAAsB,CAA3C,CAA8C,UAC/CD,eAAe,OAAG7C,GAAG,CAACC,GAAG,CAACwC,YAAD,CAAe,KAAf,CAAJ,CAAN,aAAoC,CAAnD,CACH,CAFI,IAGA,IAAIf,WAAJ,CAAiB,CAClBmB,eAAe,CAAGtC,cAAc,CAACD,iBAAD,CAAoBoB,WAAW,CAACqB,IAAhC,CAAsCrB,WAAW,CAACsB,OAAlD,CAAhC,CACH,CACD,GAAIH,eAAJ,CAAqB,CACjBI,UAAU,CAAC,UAAM,yBACbd,UAAU,MAAV,6BAAAA,UAAU,CAAEG,OAAZ,mCAAqBY,QAArB,CAA8B,CAC1BC,CAAC,CAAEC,IAAI,CAACC,GAAL,CAAS,CAAT,CAAYR,eAAe,CAAGvC,iBAA9B,CADuB,CAE1BgD,QAAQ,CAAE,IAFgB,CAA9B,EAIH,CALS,CAKP,CALO,CAAV,CAMH,CACJ,CAnBQ,CAmBN,EAnBM,CAAT,CAoBA,GAAMC,CAAAA,aAAa,CAAG3D,WAAW,CAAC,SAAC4D,UAAD,CAAgB,CAC9C,GAAMC,CAAAA,KAAK,CAAGhB,YAAY,CAACe,UAAD,CAA1B,CACA,GAAItB,WAAJ,CAAiB,CAEbA,WAAW,CAACuB,KAAD,CAAX,CACH,CAHD,IAIK,CACDtC,YAAY,MAAZ,QAAAA,YAAY,CAAGsC,KAAH,CAAZ,CACH,CACJ,CATgC,CAS9B,CAAChB,YAAD,CAAetB,YAAf,CAA6Be,WAA7B,CAT8B,CAAjC,CAUA,GAAMwB,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAM,CACvB,GAAMxC,CAAAA,MAAM,CAAGuB,YAAY,CAACxC,GAAb,CAAiB,SAACwD,KAAD,CAAQE,CAAR,CAAc,CAC1C,MAAQ,MAAC,UAAD,EAAoB,KAAK,CAAEA,CAA3B,CAA8B,KAAK,CAAEF,KAArC,CAA4C,MAAM,CAAEpB,MAAM,CAACC,OAA3D,CAAoE,SAAS,CAAExB,SAA/E,CAA0F,OAAO,CAAEyC,aAAnG,CAAkH,WAAW,CAAEjC,WAA/H,EAAiBqC,CAAjB,CAAR,CACH,CAFc,CAAf,CAGA,MAAQ,MAAC,IAAD,WACR,KAAC,IAAD,EAAM,KAAK,CAAE,CAAEC,UAAU,CAAExD,mBAAd,CAAb,UAAmDc,MAAnD,EADQ,EAAR,CAGH,CAPD,CAQA,MAAQ,OAAC,UAAD,8BAER,GAAG,CAAEiB,UAFG,CAES,qBAAqB,CAAE,CAACE,MAAM,CAACC,OAAP,CAAeuB,YAAhB,CAA8B,CAAEnB,KAAK,CAAExC,SAAS,CAACyC,WAAnB,CAA9B,CAFhC,EAEqGH,YAFrG,gBAGN,KAAC,aAAD,EAAe,KAAK,CAAEzB,KAAtB,CAA6B,GAAG,CAAEC,GAAlC,CAAuC,IAAI,CAAEC,IAA7C,CAAmD,SAAS,CAAEH,SAA9D,CAAyE,MAAM,CAAEuB,MAAM,CAACC,OAAxF,CAAiG,gBAAgB,CAAEN,gBAAnH,CAAqI,qBAAqB,CAAEC,qBAA5J,CAAmL,qBAAqB,CAAEb,qBAA1M,CAAiO,wBAAwB,CAAEC,wBAA3P,EAHM,CAILqC,YAAY,EAJP,CAKL/B,gBAAgB,EAAI,KAAC,YAAD,EAAc,MAAM,CAAEU,MAAM,CAACC,OAA7B,EALf,IAAR,CAOH,CAvDD,CAwDA,cAAe3C,CAAAA,KAAK,CAACmE,IAAN,CAAWlD,QAAX,CAAf","sourcesContent":["import React, { useCallback, useEffect, useMemo, useRef } from 'react';\nimport { View, ScrollView } from 'react-native';\nimport min from 'lodash/min';\nimport map from 'lodash/map';\nimport constants from '../commons/constants';\nimport styleConstructor, { HOURS_SIDEBAR_WIDTH } from './style';\nimport { populateEvents, HOUR_BLOCK_HEIGHT } from './Packer';\nimport { calcTimeOffset } from './helpers/presenter';\nimport TimelineHours from './TimelineHours';\nimport EventBlock from './EventBlock';\nimport NowIndicator from './NowIndicator';\nimport useTimelineOffset from './useTimelineOffset';\nconst Timeline = (props) => {\n    const { format24h = true, start = 0, end = 24, date, events = [], onEventPress, onBackgroundLongPress, onBackgroundLongPressOut, renderEvent, theme, scrollToFirst, scrollToNow, initialTime, showNowIndicator, scrollOffset, onChangeOffset, overlapEventsSpacing, rightEdgeSpacing, unavailableHours, unavailableHoursColor, eventTapped } = props;\n    const scrollView = useRef();\n    const calendarHeight = useRef((end - start) * HOUR_BLOCK_HEIGHT);\n    const styles = useRef(styleConstructor(theme || props.styles, calendarHeight.current));\n    const { scrollEvents } = useTimelineOffset({ onChangeOffset, scrollOffset, scrollViewRef: scrollView });\n    const packedEvents = useMemo(() => {\n        const width = constants.screenWidth - HOURS_SIDEBAR_WIDTH;\n        return populateEvents(events, { screenWidth: width, dayStart: start, overlapEventsSpacing, rightEdgeSpacing });\n    }, [events, start]);\n    useEffect(() => {\n        let initialPosition = 0;\n        if (scrollToNow) {\n            initialPosition = calcTimeOffset(HOUR_BLOCK_HEIGHT);\n        }\n        else if (scrollToFirst && packedEvents.length > 0) {\n            initialPosition = min(map(packedEvents, 'top')) ?? 0;\n        }\n        else if (initialTime) {\n            initialPosition = calcTimeOffset(HOUR_BLOCK_HEIGHT, initialTime.hour, initialTime.minutes);\n        }\n        if (initialPosition) {\n            setTimeout(() => {\n                scrollView?.current?.scrollTo({\n                    y: Math.max(0, initialPosition - HOUR_BLOCK_HEIGHT),\n                    animated: true\n                });\n            }, 0);\n        }\n    }, []);\n    const _onEventPress = useCallback((eventIndex) => {\n        const event = packedEvents[eventIndex];\n        if (eventTapped) {\n            //TODO: remove after deprecation\n            eventTapped(event);\n        }\n        else {\n            onEventPress?.(event);\n        }\n    }, [packedEvents, onEventPress, eventTapped]);\n    const renderEvents = () => {\n        const events = packedEvents.map((event, i) => {\n            return (<EventBlock key={i} index={i} event={event} styles={styles.current} format24h={format24h} onPress={_onEventPress} renderEvent={renderEvent}/>);\n        });\n        return (<View>\n        <View style={{ marginLeft: HOURS_SIDEBAR_WIDTH }}>{events}</View>\n      </View>);\n    };\n    return (<ScrollView \n    // @ts-expect-error\n    ref={scrollView} contentContainerStyle={[styles.current.contentStyle, { width: constants.screenWidth }]} {...scrollEvents}>\n      <TimelineHours start={start} end={end} date={date} format24h={format24h} styles={styles.current} unavailableHours={unavailableHours} unavailableHoursColor={unavailableHoursColor} onBackgroundLongPress={onBackgroundLongPress} onBackgroundLongPressOut={onBackgroundLongPressOut}/>\n      {renderEvents()}\n      {showNowIndicator && <NowIndicator styles={styles.current}/>}\n    </ScrollView>);\n};\nexport default React.memo(Timeline);\n"]},"metadata":{},"sourceType":"module"}