{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/defineProperty\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}import React,{forwardRef,useCallback,useEffect,useMemo,useRef}from'react';import{DataProvider,LayoutProvider,RecyclerListView}from'recyclerlistview';import inRange from'lodash/inRange';import debounce from'lodash/debounce';import noop from'lodash/noop';import constants from\"../commons/constants\";import useCombinedRefs from\"../commons/useCombinedRefs\";import{jsx as _jsx}from\"react/jsx-runtime\";var dataProviderMaker=function dataProviderMaker(items){return new DataProvider(function(item1,item2){return item1!==item2;}).cloneWithRows(items);};var InfiniteList=function InfiniteList(props,ref){var renderItem=props.renderItem,data=props.data,_props$reloadPages=props.reloadPages,reloadPages=_props$reloadPages===void 0?noop:_props$reloadPages,_props$pageWidth=props.pageWidth,pageWidth=_props$pageWidth===void 0?constants.screenWidth:_props$pageWidth,_props$pageHeight=props.pageHeight,pageHeight=_props$pageHeight===void 0?constants.screenHeight:_props$pageHeight,onPageChange=props.onPageChange,onReachEdge=props.onReachEdge,onReachNearEdge=props.onReachNearEdge,onReachNearEdgeThreshold=props.onReachNearEdgeThreshold,_props$initialPageInd=props.initialPageIndex,initialPageIndex=_props$initialPageInd===void 0?0:_props$initialPageInd,extendedState=props.extendedState,scrollViewProps=props.scrollViewProps;var dataProvider=useMemo(function(){return dataProviderMaker(data);},[data]);var layoutProvider=useRef(new LayoutProvider(function(){return'page';},function(_type,dim){dim.width=pageWidth;dim.height=pageHeight;}));var listRef=useCombinedRefs(ref);var pageIndex=useRef();var isOnEdge=useRef(false);var isNearEdge=useRef(false);var scrolledByUser=useRef(false);var reloadPagesDebounce=useCallback(debounce(reloadPages,500,{leading:false,trailing:true}),[reloadPages]);useEffect(function(){setTimeout(function(){var _listRef$current;(_listRef$current=listRef.current)==null?void 0:_listRef$current.scrollToOffset==null?void 0:_listRef$current.scrollToOffset(Math.floor(data.length/2)*pageWidth,0,false);},0);},[data]);var onScroll=useCallback(function(event,offsetX,offsetY){reloadPagesDebounce==null?void 0:reloadPagesDebounce.cancel();var newPageIndex=Math.round(event.nativeEvent.contentOffset.x/pageWidth);if(pageIndex.current!==newPageIndex){if(pageIndex.current!==undefined){onPageChange==null?void 0:onPageChange(newPageIndex,pageIndex.current,{scrolledByUser:scrolledByUser.current});scrolledByUser.current=false;isOnEdge.current=false;isNearEdge.current=false;if(newPageIndex===0||newPageIndex===data.length-1){isOnEdge.current=true;}else if(onReachNearEdgeThreshold&&!inRange(newPageIndex,onReachNearEdgeThreshold,data.length-onReachNearEdgeThreshold)){isNearEdge.current=true;}}pageIndex.current=newPageIndex;}props.onScroll==null?void 0:props.onScroll(event,offsetX,offsetY);},[props.onScroll,onPageChange,data.length,reloadPagesDebounce]);var onMomentumScrollEnd=useCallback(function(event){if(isOnEdge.current){onReachEdge==null?void 0:onReachEdge(pageIndex.current);reloadPagesDebounce==null?void 0:reloadPagesDebounce(pageIndex.current);}else if(isNearEdge.current){reloadPagesDebounce==null?void 0:reloadPagesDebounce(pageIndex.current);onReachNearEdge==null?void 0:onReachNearEdge(pageIndex.current);}scrollViewProps==null?void 0:scrollViewProps.onMomentumScrollEnd==null?void 0:scrollViewProps.onMomentumScrollEnd(event);},[scrollViewProps==null?void 0:scrollViewProps.onMomentumScrollEnd,onReachEdge,onReachNearEdge,reloadPagesDebounce]);var onScrollBeginDrag=useCallback(function(){scrolledByUser.current=true;},[]);var style=useMemo(function(){return{height:pageHeight};},[pageHeight]);return _jsx(RecyclerListView,{ref:listRef,isHorizontal:true,rowRenderer:renderItem,dataProvider:dataProvider,layoutProvider:layoutProvider.current,extendedState:extendedState,initialRenderIndex:initialPageIndex,renderAheadOffset:5*pageWidth,onScroll:onScroll,style:style,scrollViewProps:_objectSpread(_objectSpread({pagingEnabled:true,bounces:false},scrollViewProps),{},{onScrollBeginDrag:onScrollBeginDrag,onMomentumScrollEnd:onMomentumScrollEnd})});};export default forwardRef(InfiniteList);","map":{"version":3,"sources":["/Users/mikebaker/health_tracker/client/node_modules/react-native-calendars/src/infinite-list/index.js"],"names":["React","forwardRef","useCallback","useEffect","useMemo","useRef","DataProvider","LayoutProvider","RecyclerListView","inRange","debounce","noop","constants","useCombinedRefs","dataProviderMaker","items","item1","item2","cloneWithRows","InfiniteList","props","ref","renderItem","data","reloadPages","pageWidth","screenWidth","pageHeight","screenHeight","onPageChange","onReachEdge","onReachNearEdge","onReachNearEdgeThreshold","initialPageIndex","extendedState","scrollViewProps","dataProvider","layoutProvider","_type","dim","width","height","listRef","pageIndex","isOnEdge","isNearEdge","scrolledByUser","reloadPagesDebounce","leading","trailing","setTimeout","current","scrollToOffset","Math","floor","length","onScroll","event","offsetX","offsetY","cancel","newPageIndex","round","nativeEvent","contentOffset","x","undefined","onMomentumScrollEnd","onScrollBeginDrag","style","pagingEnabled","bounces"],"mappings":"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","sourcesContent":["// TODO: Make this a common component for all horizontal lists in this lib\nimport React, { forwardRef, useCallback, useEffect, useMemo, useRef } from 'react';\nimport { DataProvider, LayoutProvider, RecyclerListView } from 'recyclerlistview';\nimport inRange from 'lodash/inRange';\nimport debounce from 'lodash/debounce';\nimport noop from 'lodash/noop';\nimport constants from '../commons/constants';\nimport useCombinedRefs from '../commons/useCombinedRefs';\nconst dataProviderMaker = (items) => new DataProvider((item1, item2) => item1 !== item2).cloneWithRows(items);\nconst InfiniteList = (props, ref) => {\n    const { renderItem, data, reloadPages = noop, pageWidth = constants.screenWidth, pageHeight = constants.screenHeight, onPageChange, onReachEdge, onReachNearEdge, onReachNearEdgeThreshold, initialPageIndex = 0, extendedState, scrollViewProps } = props;\n    const dataProvider = useMemo(() => {\n        return dataProviderMaker(data);\n    }, [data]);\n    const layoutProvider = useRef(new LayoutProvider(() => 'page', (_type, dim) => {\n        dim.width = pageWidth;\n        dim.height = pageHeight;\n    }));\n    const listRef = useCombinedRefs(ref);\n    const pageIndex = useRef();\n    const isOnEdge = useRef(false);\n    const isNearEdge = useRef(false);\n    const scrolledByUser = useRef(false);\n    const reloadPagesDebounce = useCallback(debounce(reloadPages, 500, { leading: false, trailing: true }), [reloadPages]);\n    useEffect(() => {\n        setTimeout(() => {\n            // @ts-expect-error\n            listRef.current?.scrollToOffset?.(Math.floor(data.length / 2) * pageWidth, 0, false);\n        }, 0);\n    }, [data]);\n    const onScroll = useCallback((event, offsetX, offsetY) => {\n        reloadPagesDebounce?.cancel();\n        const newPageIndex = Math.round(event.nativeEvent.contentOffset.x / pageWidth);\n        if (pageIndex.current !== newPageIndex) {\n            if (pageIndex.current !== undefined) {\n                onPageChange?.(newPageIndex, pageIndex.current, { scrolledByUser: scrolledByUser.current });\n                scrolledByUser.current = false;\n                isOnEdge.current = false;\n                isNearEdge.current = false;\n                if (newPageIndex === 0 || newPageIndex === data.length - 1) {\n                    isOnEdge.current = true;\n                }\n                else if (onReachNearEdgeThreshold &&\n                    !inRange(newPageIndex, onReachNearEdgeThreshold, data.length - onReachNearEdgeThreshold)) {\n                    isNearEdge.current = true;\n                }\n            }\n            pageIndex.current = newPageIndex;\n        }\n        props.onScroll?.(event, offsetX, offsetY);\n    }, [props.onScroll, onPageChange, data.length, reloadPagesDebounce]);\n    const onMomentumScrollEnd = useCallback(event => {\n        if (isOnEdge.current) {\n            onReachEdge?.(pageIndex.current);\n            reloadPagesDebounce?.(pageIndex.current);\n        }\n        else if (isNearEdge.current) {\n            reloadPagesDebounce?.(pageIndex.current);\n            onReachNearEdge?.(pageIndex.current);\n        }\n        scrollViewProps?.onMomentumScrollEnd?.(event);\n    }, [scrollViewProps?.onMomentumScrollEnd, onReachEdge, onReachNearEdge, reloadPagesDebounce]);\n    const onScrollBeginDrag = useCallback(() => {\n        scrolledByUser.current = true;\n    }, []);\n    const style = useMemo(() => {\n        return { height: pageHeight };\n    }, [pageHeight]);\n    return (<RecyclerListView \n    // @ts-expect-error\n    ref={listRef} isHorizontal rowRenderer={renderItem} dataProvider={dataProvider} layoutProvider={layoutProvider.current} extendedState={extendedState} initialRenderIndex={initialPageIndex} renderAheadOffset={5 * pageWidth} onScroll={onScroll} style={style} scrollViewProps={{\n            pagingEnabled: true,\n            bounces: false,\n            ...scrollViewProps,\n            onScrollBeginDrag,\n            onMomentumScrollEnd\n        }}/>);\n};\nexport default forwardRef(InfiniteList);\n"]},"metadata":{},"sourceType":"module"}