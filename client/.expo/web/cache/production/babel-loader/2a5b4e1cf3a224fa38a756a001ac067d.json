{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}import React,{useCallback,useContext,useEffect,useRef,useState}from'react';import throttle from'lodash/throttle';import XDate from'xdate';import Context from\"../expandableCalendar/Context\";import{UpdateSources}from\"../expandableCalendar/commons\";import{isToday}from\"../dateutils\";import Timeline from\"../timeline/Timeline\";import InfiniteList from\"../infinite-list\";import useTimelinePages,{INITIAL_PAGE,NEAR_EDGE_THRESHOLD}from\"./useTimelinePages\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var TimelineList=function TimelineList(props){var timelineProps=props.timelineProps,events=props.events,renderItem=props.renderItem,showNowIndicator=props.showNowIndicator,scrollToFirst=props.scrollToFirst,scrollToNow=props.scrollToNow,initialTime=props.initialTime;var _useContext=useContext(Context),date=_useContext.date,updateSource=_useContext.updateSource,setDate=_useContext.setDate;var listRef=useRef();var prevDate=useRef(date);var _useState=useState(),_useState2=_slicedToArray(_useState,2),timelineOffset=_useState2[0],setTimelineOffset=_useState2[1];var _useTimelinePages=useTimelinePages({date:date,listRef:listRef}),pages=_useTimelinePages.pages,pagesRef=_useTimelinePages.pagesRef,resetPages=_useTimelinePages.resetPages,resetPagesDebounce=_useTimelinePages.resetPagesDebounce,scrollToPageDebounce=_useTimelinePages.scrollToPageDebounce,shouldResetPages=_useTimelinePages.shouldResetPages,isOutOfRange=_useTimelinePages.isOutOfRange;useEffect(function(){if(date!==prevDate.current){var datePageIndex=pagesRef.current.indexOf(date);if(updateSource!==UpdateSources.LIST_DRAG){if(isOutOfRange(datePageIndex)){updateSource===UpdateSources.DAY_PRESS?resetPages(date):resetPagesDebounce(date);}else{scrollToPageDebounce(datePageIndex);}}prevDate.current=date;}},[date,updateSource]);var onScroll=useCallback(function(){if(shouldResetPages.current){resetPagesDebounce.cancel();}},[]);var onMomentumScrollEnd=useCallback(function(){if(shouldResetPages.current){resetPagesDebounce(prevDate.current);}},[]);var onPageChange=useCallback(throttle(function(pageIndex){var newDate=pagesRef.current[pageIndex];if(newDate!==prevDate.current){setDate(newDate,UpdateSources.LIST_DRAG);}},0),[]);var onReachNearEdge=useCallback(function(){shouldResetPages.current=true;},[]);var onTimelineOffsetChange=useCallback(function(offset){setTimelineOffset(offset);},[]);var renderPage=useCallback(function(_type,item,index){var timelineEvent=events[item];var isCurrent=prevDate.current===item;var isInitialPage=index===INITIAL_PAGE;var _isToday=isToday(new XDate(item));var _timelineProps=_objectSpread(_objectSpread({},timelineProps),{},{key:item,date:item,events:timelineEvent,scrollToNow:_isToday&&isInitialPage&&scrollToNow,initialTime:!_isToday&&isInitialPage?initialTime:undefined,scrollToFirst:!_isToday&&isInitialPage&&scrollToFirst,scrollOffset:timelineOffset,onChangeOffset:onTimelineOffsetChange,showNowIndicator:_isToday&&showNowIndicator});if(renderItem){return renderItem(_timelineProps,{item:item,index:index,isCurrent:isCurrent,isInitialPage:isInitialPage,isToday:_isToday});}return _jsx(_Fragment,{children:_jsx(Timeline,_objectSpread({},_timelineProps))});},[events,timelineOffset,showNowIndicator]);return _jsx(InfiniteList,{ref:listRef,data:pages,renderItem:renderPage,onPageChange:onPageChange,onReachNearEdge:onReachNearEdge,onReachNearEdgeThreshold:NEAR_EDGE_THRESHOLD,onScroll:onScroll,extendedState:{todayEvents:events[date],pages:pages},initialPageIndex:INITIAL_PAGE,scrollViewProps:{onMomentumScrollEnd:onMomentumScrollEnd}});};export default TimelineList;","map":{"version":3,"sources":["/Users/mikebaker/health_tracker/client/node_modules/react-native-calendars/src/timeline-list/index.js"],"names":["React","useCallback","useContext","useEffect","useRef","useState","throttle","XDate","Context","UpdateSources","isToday","Timeline","InfiniteList","useTimelinePages","INITIAL_PAGE","NEAR_EDGE_THRESHOLD","TimelineList","props","timelineProps","events","renderItem","showNowIndicator","scrollToFirst","scrollToNow","initialTime","date","updateSource","setDate","listRef","prevDate","timelineOffset","setTimelineOffset","pages","pagesRef","resetPages","resetPagesDebounce","scrollToPageDebounce","shouldResetPages","isOutOfRange","current","datePageIndex","indexOf","LIST_DRAG","DAY_PRESS","onScroll","cancel","onMomentumScrollEnd","onPageChange","pageIndex","newDate","onReachNearEdge","onTimelineOffsetChange","offset","renderPage","_type","item","index","timelineEvent","isCurrent","isInitialPage","_isToday","_timelineProps","key","undefined","scrollOffset","onChangeOffset","todayEvents"],"mappings":"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","sourcesContent":["import React, { useCallback, useContext, useEffect, useRef, useState } from 'react';\n// import {Text} from 'react-native';\nimport throttle from 'lodash/throttle';\nimport XDate from 'xdate';\nimport Context from '../expandableCalendar/Context';\nimport { UpdateSources } from '../expandableCalendar/commons';\nimport { isToday } from '../dateutils';\nimport Timeline from '../timeline/Timeline';\nimport InfiniteList from '../infinite-list';\nimport useTimelinePages, { INITIAL_PAGE, NEAR_EDGE_THRESHOLD } from './useTimelinePages';\nconst TimelineList = (props) => {\n    const { timelineProps, events, renderItem, showNowIndicator, scrollToFirst, scrollToNow, initialTime } = props;\n    const { date, updateSource, setDate } = useContext(Context);\n    const listRef = useRef();\n    const prevDate = useRef(date);\n    const [timelineOffset, setTimelineOffset] = useState();\n    const { pages, pagesRef, resetPages, resetPagesDebounce, scrollToPageDebounce, shouldResetPages, isOutOfRange } = useTimelinePages({ date, listRef });\n    useEffect(() => {\n        if (date !== prevDate.current) {\n            const datePageIndex = pagesRef.current.indexOf(date);\n            if (updateSource !== UpdateSources.LIST_DRAG) {\n                if (isOutOfRange(datePageIndex)) {\n                    updateSource === UpdateSources.DAY_PRESS ? resetPages(date) : resetPagesDebounce(date);\n                }\n                else {\n                    scrollToPageDebounce(datePageIndex);\n                }\n            }\n            prevDate.current = date;\n        }\n    }, [date, updateSource]);\n    const onScroll = useCallback(() => {\n        if (shouldResetPages.current) {\n            resetPagesDebounce.cancel();\n        }\n    }, []);\n    const onMomentumScrollEnd = useCallback(() => {\n        if (shouldResetPages.current) {\n            resetPagesDebounce(prevDate.current);\n        }\n    }, []);\n    const onPageChange = useCallback(throttle((pageIndex) => {\n        const newDate = pagesRef.current[pageIndex];\n        if (newDate !== prevDate.current) {\n            setDate(newDate, UpdateSources.LIST_DRAG);\n        }\n    }, 0), []);\n    const onReachNearEdge = useCallback(() => {\n        shouldResetPages.current = true;\n    }, []);\n    const onTimelineOffsetChange = useCallback(offset => {\n        setTimelineOffset(offset);\n    }, []);\n    const renderPage = useCallback((_type, item, index) => {\n        const timelineEvent = events[item];\n        const isCurrent = prevDate.current === item;\n        const isInitialPage = index === INITIAL_PAGE;\n        const _isToday = isToday(new XDate(item));\n        const _timelineProps = {\n            ...timelineProps,\n            key: item,\n            date: item,\n            events: timelineEvent,\n            scrollToNow: _isToday && isInitialPage && scrollToNow,\n            initialTime: !_isToday && isInitialPage ? initialTime : undefined,\n            scrollToFirst: !_isToday && isInitialPage && scrollToFirst,\n            scrollOffset: timelineOffset,\n            onChangeOffset: onTimelineOffsetChange,\n            showNowIndicator: _isToday && showNowIndicator\n        };\n        if (renderItem) {\n            return renderItem(_timelineProps, { item, index, isCurrent, isInitialPage, isToday: _isToday });\n        }\n        return (<>\n          <Timeline {..._timelineProps}/>\n          {/* NOTE: Keeping this for easy debugging */}\n          {/* <Text style={{position: 'absolute'}}>{item}</Text> */}\n        </>);\n    }, [events, timelineOffset, showNowIndicator]);\n    return (<InfiniteList ref={listRef} data={pages} renderItem={renderPage} onPageChange={onPageChange} onReachNearEdge={onReachNearEdge} onReachNearEdgeThreshold={NEAR_EDGE_THRESHOLD} onScroll={onScroll} extendedState={{ todayEvents: events[date], pages }} initialPageIndex={INITIAL_PAGE} scrollViewProps={{\n            onMomentumScrollEnd\n        }}/>);\n};\nexport default TimelineList;\n"]},"metadata":{},"sourceType":"module"}