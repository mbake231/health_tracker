{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _extends from\"@babel/runtime/helpers/extends\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}import React,{useCallback,useContext,useEffect,useMemo,useRef,useState}from'react';import View from\"react-native-web/dist/exports/View\";import XDate from'xdate';import InfiniteList from\"../../infinite-list\";import Week from\"../week\";import WeekDaysNames from\"../../commons/WeekDaysNames\";import CalendarContext from\"../../expandableCalendar/Context\";import styleConstructor from\"../style\";import{toMarkingFormat}from\"../../interface\";import{extractComponentProps}from\"../../componentUpdater\";import constants from\"../../commons/constants\";import{UpdateSources}from\"../commons\";import{sameWeek}from\"../../dateutils\";import{createElement as _createElement}from\"react\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var NUMBER_OF_PAGES=50;var WeekCalendar=function WeekCalendar(props){var current=props.current,_props$firstDay=props.firstDay,firstDay=_props$firstDay===void 0?0:_props$firstDay,markedDates=props.markedDates,_props$allowShadow=props.allowShadow,allowShadow=_props$allowShadow===void 0?true:_props$allowShadow,hideDayNames=props.hideDayNames,theme=props.theme,calendarWidth=props.calendarWidth,testID=props.testID;var context=useContext(CalendarContext);var date=context.date,updateSource=context.updateSource;var style=useRef(styleConstructor(theme));var list=useRef();var _useState=useState(getDatesArray(current||date,firstDay,NUMBER_OF_PAGES)),_useState2=_slicedToArray(_useState,2),items=_useState2[0],setItems=_useState2[1];var extraData={current:current,date:context.date,firstDay:firstDay};var containerWidth=calendarWidth||constants.screenWidth;var weekStyle=useMemo(function(){return[{width:containerWidth},props.style];},[containerWidth,props.style]);useEffect(function(){if(updateSource!==UpdateSources.WEEK_SCROLL){var _list$current;var pageIndex=items.findIndex(function(item){return sameWeek(item,date,firstDay);});(_list$current=list.current)==null?void 0:_list$current.scrollToOffset==null?void 0:_list$current.scrollToOffset(pageIndex*containerWidth,0,false);}},[date]);var onDayPress=useCallback(function(dateData){context.setDate==null?void 0:context.setDate(dateData.dateString,UpdateSources.DAY_PRESS);props.onDayPress==null?void 0:props.onDayPress(dateData);},[props.onDayPress]);var onPageChange=useCallback(function(pageIndex,_prevPage,_ref){var scrolledByUser=_ref.scrolledByUser;if(scrolledByUser){context==null?void 0:context.setDate(items[pageIndex],UpdateSources.WEEK_SCROLL);}},[items]);var reloadPages=useCallback(function(pageIndex){var date=items[pageIndex];setItems(getDatesArray(date,firstDay,NUMBER_OF_PAGES));},[items]);var renderItem=useCallback(function(_type,item){var _extractComponentProp=extractComponentProps(Week,props),others=_extends({},_extractComponentProp);var isSameWeek=sameWeek(item,date,firstDay);return _createElement(Week,_objectSpread(_objectSpread({},others),{},{key:item,current:isSameWeek?date:item,firstDay:firstDay,style:weekStyle,markedDates:markedDates,onDayPress:onDayPress,context:context}));},[date,markedDates]);return _jsxs(View,{testID:testID,style:[allowShadow&&style.current.containerShadow,!hideDayNames&&style.current.containerWrapper],children:[!hideDayNames&&_jsx(View,{style:[style.current.week,style.current.weekCalendar],children:_jsx(WeekDaysNames,{firstDay:firstDay,style:style.current.dayHeader})}),_jsx(View,{children:_jsx(InfiniteList,{ref:list,data:items,renderItem:renderItem,reloadPages:reloadPages,onReachNearEdgeThreshold:Math.round(NUMBER_OF_PAGES*0.4),extendedState:extraData,style:style.current.container,initialPageIndex:NUMBER_OF_PAGES,pageHeight:48,pageWidth:containerWidth,onPageChange:onPageChange,scrollViewProps:{showsHorizontalScrollIndicator:false}},\"week-list\")})]});};export default WeekCalendar;function getDate(date,firstDay,weekIndex){var d=new XDate(date);var dayOfTheWeek=d.getDay();if(dayOfTheWeek<firstDay&&firstDay>0){dayOfTheWeek=7+dayOfTheWeek;}var dd=weekIndex===0?d:d.addDays(firstDay-dayOfTheWeek);var newDate=dd.addWeeks(weekIndex);return toMarkingFormat(newDate);}function getDatesArray(date,firstDay){var numberOfPages=arguments.length>2&&arguments[2]!==undefined?arguments[2]:NUMBER_OF_PAGES;var array=[];for(var index=-numberOfPages;index<=numberOfPages;index++){var d=getDate(date,firstDay,index);array.push(d);}return array;}","map":{"version":3,"sources":["/Users/mikebaker/health_tracker/client/node_modules/react-native-calendars/src/expandableCalendar/WeekCalendar/new.js"],"names":["React","useCallback","useContext","useEffect","useMemo","useRef","useState","XDate","InfiniteList","Week","WeekDaysNames","CalendarContext","styleConstructor","toMarkingFormat","extractComponentProps","constants","UpdateSources","sameWeek","NUMBER_OF_PAGES","WeekCalendar","props","current","firstDay","markedDates","allowShadow","hideDayNames","theme","calendarWidth","testID","context","date","updateSource","style","list","getDatesArray","items","setItems","extraData","containerWidth","screenWidth","weekStyle","width","WEEK_SCROLL","pageIndex","findIndex","item","scrollToOffset","onDayPress","dateData","setDate","dateString","DAY_PRESS","onPageChange","_prevPage","scrolledByUser","reloadPages","renderItem","_type","others","isSameWeek","containerShadow","containerWrapper","week","weekCalendar","dayHeader","Math","round","container","showsHorizontalScrollIndicator","getDate","weekIndex","d","dayOfTheWeek","getDay","dd","addDays","newDate","addWeeks","numberOfPages","array","index","push"],"mappings":"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","sourcesContent":["import React, { useCallback, useContext, useEffect, useMemo, useRef, useState } from 'react';\nimport { View } from 'react-native';\nimport XDate from 'xdate';\nimport InfiniteList from '../../infinite-list';\nimport Week from '../week';\nimport WeekDaysNames from '../../commons/WeekDaysNames';\nimport CalendarContext from '../../expandableCalendar/Context';\nimport styleConstructor from '../style';\nimport { toMarkingFormat } from '../../interface';\nimport { extractComponentProps } from '../../componentUpdater';\nimport constants from '../../commons/constants';\nimport { UpdateSources } from '../commons';\nimport { sameWeek } from '../../dateutils';\nconst NUMBER_OF_PAGES = 50;\nconst WeekCalendar = (props) => {\n    const { current, firstDay = 0, markedDates, allowShadow = true, hideDayNames, theme, calendarWidth, testID } = props;\n    const context = useContext(CalendarContext);\n    const { date, updateSource } = context;\n    const style = useRef(styleConstructor(theme));\n    const list = useRef();\n    const [items, setItems] = useState(getDatesArray(current || date, firstDay, NUMBER_OF_PAGES));\n    const extraData = {\n        current,\n        date: context.date,\n        firstDay\n    };\n    const containerWidth = calendarWidth || constants.screenWidth;\n    const weekStyle = useMemo(() => {\n        return [{ width: containerWidth }, props.style];\n    }, [containerWidth, props.style]);\n    useEffect(() => {\n        if (updateSource !== UpdateSources.WEEK_SCROLL) {\n            const pageIndex = items.findIndex(item => sameWeek(item, date, firstDay));\n            // @ts-expect-error\n            list.current?.scrollToOffset?.(pageIndex * containerWidth, 0, false);\n        }\n    }, [date]);\n    const onDayPress = useCallback((dateData) => {\n        context.setDate?.(dateData.dateString, UpdateSources.DAY_PRESS);\n        props.onDayPress?.(dateData);\n    }, [props.onDayPress]);\n    const onPageChange = useCallback((pageIndex, _prevPage, { scrolledByUser }) => {\n        if (scrolledByUser) {\n            context?.setDate(items[pageIndex], UpdateSources.WEEK_SCROLL);\n        }\n    }, [items]);\n    const reloadPages = useCallback(pageIndex => {\n        const date = items[pageIndex];\n        setItems(getDatesArray(date, firstDay, NUMBER_OF_PAGES));\n    }, [items]);\n    const renderItem = useCallback((_type, item) => {\n        const { /* style,  */ ...others } = extractComponentProps(Week, props);\n        const isSameWeek = sameWeek(item, date, firstDay);\n        return (<Week {...others} key={item} current={isSameWeek ? date : item} firstDay={firstDay} style={weekStyle} markedDates={markedDates} onDayPress={onDayPress} \n        // context={currentContext}\n        context={context}/>);\n    }, [date, markedDates]);\n    return (<View testID={testID} style={[allowShadow && style.current.containerShadow, !hideDayNames && style.current.containerWrapper]}>\n      {!hideDayNames && (<View style={[style.current.week, style.current.weekCalendar]}>\n          <WeekDaysNames firstDay={firstDay} style={style.current.dayHeader}/>\n        </View>)}\n      <View>\n        <InfiniteList key=\"week-list\" ref={list} data={items} renderItem={renderItem} reloadPages={reloadPages} onReachNearEdgeThreshold={Math.round(NUMBER_OF_PAGES * 0.4)} extendedState={extraData} style={style.current.container} initialPageIndex={NUMBER_OF_PAGES} pageHeight={48} pageWidth={containerWidth} onPageChange={onPageChange} scrollViewProps={{\n            showsHorizontalScrollIndicator: false\n        }}/>\n      </View>\n    </View>);\n};\nexport default WeekCalendar;\n// function getDate({current, context, firstDay = 0}: WeekCalendarProps, weekIndex: number) {\nfunction getDate(date, firstDay, weekIndex) {\n    // const d = new XDate(current || context.date);\n    const d = new XDate(date);\n    // get the first day of the week as date (for the on scroll mark)\n    let dayOfTheWeek = d.getDay();\n    if (dayOfTheWeek < firstDay && firstDay > 0) {\n        dayOfTheWeek = 7 + dayOfTheWeek;\n    }\n    // leave the current date in the visible week as is\n    const dd = weekIndex === 0 ? d : d.addDays(firstDay - dayOfTheWeek);\n    const newDate = dd.addWeeks(weekIndex);\n    return toMarkingFormat(newDate);\n}\n// function getDatesArray(args: WeekCalendarProps, numberOfPages = NUMBER_OF_PAGES) => {\nfunction getDatesArray(date, firstDay, numberOfPages = NUMBER_OF_PAGES) {\n    const array = [];\n    for (let index = -numberOfPages; index <= numberOfPages; index++) {\n        const d = getDate(date, firstDay, index);\n        array.push(d);\n    }\n    return array;\n}\n"]},"metadata":{},"sourceType":"module"}